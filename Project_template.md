# Шаблон проектного задания

## Задание 1. Анализ и планирование

### 1. Описание функциональности монолитного приложения

#### Управление отоплением:
- Пользователи могут включать и выключать отопление, а также задавать желаемую температуру для всего дома или отдельных зон.
- Система получает команды от пользователя через веб-интерфейс, передаёт их на сервер, а затем — на исполнительные устройства (датчики и контроллеры отопления).

#### Мониторинг температуры:
- Пользователь может просматривать текущую температуру в доме или зонах через веб-интерфейс.
- Сервер опрашивает датчики температуры по запросу пользователя и отображает данные в интерфейсе.

#### Ограничения:
- Подключение новой системы и датчиков возможно только через выезд специалиста компании.
- Самостоятельное подключение новых датчиков или приборов пользователем невозможно.

### 2. Анализ архитектуры монолитного приложения

- **Язык программирования:** Go
- **Архитектурный стиль:** монолит (вся логика и обработка в одном серверном приложении)
- **База данных:** PostgreSQL
- **Взаимодействие компонентов:** синхронное, весь контроль и опрос датчиков производится с сервера по запросам.
- Нет микросервисов, нет асинхронного взаимодействия, нет шины сообщений.
- Любые интеграции или доработки требуют изменения и деплоя всего приложения целиком.

### 3. Определение доменов и границ контекстов

- **User** — управление учетными записями пользователей
- **Device/Sensor** — управление отопительным оборудованием и датчиками температуры
- **Temperature Monitoring** — сбор, обработка, хранение и визуализация данных о температуре
- **Installation/Service** — подключение новых устройств, выполняется только специалистом компании

### 4. Проблемы монолитного решения

- **Масштабируемость:** невозможно масштабировать отдельные части системы; увеличение нагрузки приводит к деградации всей системы.
- **Гибкость и развитие:** доработка/расширение любого функционала требует сборки, тестирования и выкладки всего монолита.
- **Подключение новых устройств:** пользователь не может самостоятельно расширить систему новыми датчиками (только через выезд специалиста).
- **Устойчивость:** сбой одного компонента может привести к неработоспособности всей системы.
- **Невозможность асинхронного и реактивного взаимодействия:** все запросы — синхронные, нет асинхронного обмена и интеграций.

### 5. Визуализация контекста системы — диаграмма C4

- **Диаграмма контекста (C4)** — показывает внешние пользователи и системы, взаимодействующие с основным приложением.

---

## Задание 2. Проектирование микросервисной архитектуры

### Контейнерная диаграмма (Containers)

- Представляет собой уровень C4-модели, где показаны основные контейнеры (сервисы), базы данных, клиентские приложения и внешние системы.

### Контейнерная диаграмма (C4)

- Использованы контейнеры: User Service, Device Service, Temperature Service, API Gateway, Postgres, внешние клиенты и устройства.

### Диаграммы компонентов (Components)

- **User Service Components** — модули аутентификации, управления пользователями и правами доступа.
- **Device Service Components** — управление устройствами, сенсорами и контроллерами.
- **(И другие сервисы аналогично)**

### Диаграмма кода (Code)

- Пример структуры кода внутри каждого микросервиса.
- Или список диаграмм кода для каждого микросервиса (структура пакетов, классов, обработчиков и т.д.).

---

## Задание 3. Разработка ER-диаграммы

- **ER-диаграмма** — описывает связи между сущностями в базе данных: пользователи, устройства, сенсоры, показания температуры, события и т.д.

---

## Задание 4. Создание и документирование API

### 1. Тип API

- **Тип API:** REST
- Использование REST обеспечивает простоту взаимодействия между сервисами, стандартные подходы к интеграции, удобную документацию и масштабируемость.
- Между ключевыми микросервисами используется REST-запросы через API Gateway. Для событийного обмена между сервисами в перспективе может использоваться message bus.

### 2. Документация API

- Smart Home API (Swagger)
- Temperature API (Swagger)
- Postman Collection

---

## Задание 5. Работа с Docker и docker-compose

- Все приложения и микросервисы упакованы в Docker.
- Реализован микросервис `temperature-api`, который возвращает случайное значение температуры по запросу `/temperature?location=...&sensorId=....`
- Для приложения `smart_home` используется база данных Postgres, инициализируется скриптом `init.sql`.
- Все сервисы запускаются единой командой через `docker-compose.yml`.

Пример запуска:

```bash
cd apps docker compose up -d
